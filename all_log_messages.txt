export declare function print(programJson: string, options: Buffer, signal?: AbortSignal | undefined | null): Promise<TransformOutput>
    print(m: Program, options?: Options): Promise<Output>;
export declare function print(m: Program, options?: Options): Promise<Output>;
     *   print(s);
            print('next: %u\ncount: %u\n' % (next_node, count))
                    print('%8u ' % ptr, end=' ')
                    print('         ', end=' ')
                print(e, ' (%u)' % e.byte_length())
            print('used: %u' % block.tell())
        print('root: %u\nlevels: %u\nrecords: %u\nnodes: %u\npage-size: %u' \
        print('Unknown data type %08x' % typecode)
    print(options?: WebContentsPrintOptions, callback?: (success: boolean, failureReason: string) => void): void;
     * Prints `webview`'s web page. Same as `webContents.print([options])`.
    print(options?: WebviewTagPrintOptions): Promise<void>;
print(sys.argv[1])
    print(): void;
declare function print(): void;
      addLog(`✅ Killed ${result.killed || 0} processes`);
      addLog(`❌ Error: ${result.error}`);
      addLog(`✅ Opened PDF for ${studentName}`);
      addLog(`❌ ${result.error}`);
      addLog('✅ Combined PDF opened');
      addLog(`❌ ${result.error}`);
      addLog('✅ Import file opened');
      addLog(`❌ ${result.error}`);
      addLog(`✅ Class loaded: ${newClass}`);
    addLog('📂 Loading classes from Rosters etc folder...');
        addLog(`✅ Found ${result.classes.length} classes`);
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error loading classes: ${error instanceof Error ? error.message : 'Unknown error'}`);
    addLog('📁 Opening Downloads folder...');
        addLog('✅ Downloads folder opened successfully!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('🔍 Searching for Canvas ZIP in Downloads...');
        addLog('✅ Quiz processing completed!');
        addLog('📂 Combined PDF ready for manual grading');
        addLog('📁 Multiple ZIP files found - please select one');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
    addLog(`📁 Processing selected ZIP file: ${zipFilename}`);
        addLog('✅ Quiz processing completed!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('🔍 Searching for Canvas ZIP in Downloads...');
        addLog('✅ Completion processing completed!');
        addLog('✅ Auto-assigned 10 points to all submissions');
        addLog('📁 Multiple ZIP files found - please select one');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
    addLog(`📁 Processing selected ZIP file: ${zipFilename}`);
        addLog('✅ Completion processing completed!');
        addLog('✅ Auto-assigned 10 points to all submissions');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('🔬 Starting grade extraction...');
        addLog('✅ Grade extraction completed successfully!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('📦 Starting PDF split and rezip...');
        addLog('✅ Split PDF and rezip completed!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('📂 Opening grade processing folder...');
          addLog('📁 Class folder opened (no grade processing folder found)');
          addLog('✅ Grade processing folder opened!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog('❌ Please select a class first');
    addLog('🗑️ Clearing all processing data...');
        addLog('✅ All data cleared successfully!');
        addLog(`❌ Error: ${result.error}`);
      addLog(`❌ Error: ${error instanceof Error ? error.message : 'Unknown error'}`);
      addLog(logMessage);
      result.logs.forEach((message: string) => addLog(message));
            log_callback("")
            log_callback("Existing folder found, creating backup...")
            log_callback(f"   Renaming: {os.path.basename(folder_path)}")
            log_callback(f"         to: {os.path.basename(backup_name)}")
                log_callback(f"   Backup created successfully")
                log_callback("")
                log_callback(f"   Could not create backup: {e}")
                log_callback("")
        print(json.dumps({
        logs.append(f"🗑️ Starting cleanup for {class_name} on {drive}: drive")
                logs.append(f"🗑️ Deleted ZIP: {os.path.basename(zip_file)}")
                logs.append(f"⚠️ Could not delete {os.path.basename(zip_file)}: Access denied or file in use")
                    logs.append(f"🗑️ Deleted folder: Grade Processing")
                    logs.append(f"⚠️ Could not delete Grade Processing folder: Access denied or files in use")
            logs.append("ℹ️ No files or folders found to clean up")
        logs.append(f"✅ Cleanup completed - {deleted_zips} ZIP files and {deleted_folders} folders removed")
            print(log)
        print(f"SUCCESS: Cleanup completed - {deleted_zips} ZIP files and {deleted_folders} folders removed")
        print(f"🗑️ Starting cleanup for {class_name} on {drive}: drive")
        print(f"❌ Error: {str(e)}")
        print(f"ERROR: {str(e)}")
        print(f"Warning: Could not load config file: {e}", file=sys.stderr)
        print(json.dumps({
        def log_callback(message):
            all_logs.append(message)
        print("🔬 Starting grade extraction...")
        print("")
            print("📋 EXTRACTED GRADES:")
                print(f"   {i:2d}. {sg['name']}: {sg['grade']} {conf_indicator} (confidence: {conf:.2f})")
            print("📋 EXTRACTED GRADES:")
                print(f"   {i:2d}. {name}: {grade} {conf_indicator} (confidence: {conf:.2f})")
        print("")
        print(f"📊 Processed {len(grades_result) if grades_result else 0} students")
        print("")
        print("✅ Grade extraction complete!")
            print("")
            print("⚠️ ISSUES FOUND (Please Review):")
                    print(f"   ❌ {clean_msg}")
                    print(f"   ⚠️ {clean_msg}")
        print("")
        print(friendly_error)
        print("")
def extract_grades(pdf_path, log=lambda msg: print(msg), debug_images_folder=None):
    print(f"WARNING: Failed to load extract_grades_simple module: {e}")
        log_callback("Looking for quiz files in Downloads...")
            log_callback("No quiz files found in Downloads")
        log_callback("")
        log_callback(f"Found quiz file: {os.path.basename(chosen_zip)}")
        log_callback(f"Assignment: {assignment_name}")
        log_callback("")
        log_callback(f"Extracting to: {extraction_folder}")
                log_callback("   Preserved original index.html")
        log_callback("")
        log_callback(f"Extracted {folder_count} student folders")
            log_callback(f"   Preserved index.html from original ZIP")
        log_callback("")
            log_callback(f"Drive: {drive_letter}:")
            log_callback(f"Class: {class_folder_name}")
            log_callback(f"Processing folder: {processing_folder}")
            log_callback("-" * 60)
            log_callback(f"Assignment: {assignment_name}")
            log_callback(f"   PDF saved as: {os.path.basename(combined_pdf_path)}")
            log_callback("")
            log_callback("=" * 60)
            log_callback("COMBINED PDF CREATED!")
            log_callback("Ready for grading or splitting back to individual PDFs")
            log_callback("=" * 60)
            log_callback("")
            log_callback("")
            log_callback(f"ERROR: {str(e)}")
            log_callback(f"Drive: {drive_letter}:")
            log_callback(f"Class: {class_folder_name}")
            log_callback(f"Processing folder: {processing_folder}")
            log_callback("-" * 60)
            log_callback(f"Found combined PDF: {os.path.basename(combined_pdf_path)}")
            log_callback("")
            log_callback("=" * 60)
            log_callback("REVERSE PROCESSING COMPLETE!")
            log_callback(f"Processed {students_processed} students")
            log_callback("=" * 60)
            log_callback("")
            log_callback("")
            log_callback(f"ERROR: {str(e)}")
            log_callback(f"Drive: {drive_letter}:")
            log_callback(f"Class: {class_folder_name}")
            log_callback(f"Processing folder: {processing_folder}")
            log_callback("-" * 60)
            log_callback(f"Assignment: {assignment_name}")
            log_callback(f"   PDF saved as: {os.path.basename(combined_pdf_path)}")
            log_callback("")
            log_callback("Setting up Import File column...")
                        log_callback(f"   Created column: '{column_name}'")
                        log_callback(f"   Added column: '{column_name}'")
                        log_callback(f"   ❌ {friendly_msg}")
                            log_callback(f"   ❌ {friendly_msg}")
                    log_callback(f"   Import File ready for grade extraction")
                    log_callback(f"   Column already exists: '{column_name}'")
                log_callback(f"   Could not setup Import File: {e}")
                log_callback("")
                log_callback("Opening combined PDF for manual grading...")
                log_callback(f"   Could not open PDF: {e}")
            log_callback("")
            log_callback("=" * 60)
            log_callback("PROCESSING COMPLETE!")
            log_callback("=" * 60)
            log_callback("")
            log_callback("")
            log_callback(f"ERROR: {str(e)}")
            log_callback(f"Drive: {drive_letter}:")
            log_callback(f"Class: {class_folder_name}")
            log_callback(f"Processing folder: {processing_folder}")
            log_callback("-" * 60)
            log_callback(f"Assignment: {assignment_name}")
            log_callback(f"   PDF saved as: {os.path.basename(combined_pdf_path)}")
            log_callback("")
            log_callback("=" * 60)
            log_callback("COMPLETION PROCESSING COMPLETE!")
            log_callback(f"✅ Auto-assigned 10 points to {len(submitted)} submissions")
            log_callback("=" * 60)
                log_callback("")
                log_callback("❌ STUDENT ERRORS AND WARNINGS:")
                    log_callback(f"❌ {error}")
            log_callback("")
            log_callback("")
            log_callback(f"ERROR: {str(e)}")
        print(json.dumps({
    print(json.dumps(result, indent=2))
                log_callback("   📋 Closed Excel to save import file")
            log_callback("   ⚠️  End-of-Line Indicator not found - adding it to column F")
            log_callback("   ✅ Added End-of-Line Indicator column")
            log_callback(f"Import File not found: {import_file_path}")
        log_callback("")
        log_callback(f"Loaded Import File: {len(df)} students")
        log_callback("")
            log_callback("")
            log_callback("-" * 40)
            log_callback("UPDATING IMPORT FILE")
            log_callback("-" * 40)
            log_callback(f"Current columns: {list(import_df.columns)}")
            log_callback("")
            log_callback(f"   New column name: '{column_name}'")
            log_callback(f"   Updating grades...")
            log_callback(f"   Saving to: {import_file_path}")
            log_callback("")
                log_callback("   ⚠️  Fuzzy name matches (please verify):")
                    log_callback(warning)
                log_callback("")
            log_callback(f"Updated grades for {len(import_df)} students")
            log_callback("")
                log_callback(f"Error updating import file: {error_msg}")
            log_callback(f"   🧹 Cleaning up {len(columns_to_remove)} corrupted columns after End-of-Line Indicator")
        log_callback(f"   Mode: Don't override - adding new column before End-of-Line Indicator")
            log_callback(f"   Warning: Less than 5 columns, adding empty columns")
            log_callback(f"   Column '{column_name}' already exists, using existing column")
            log_callback(f"   Added new column '{column_name}' at index {eol_index} (before '{eol_col_name}')")
        log_callback(f"   Mode: Override - removing old grade columns")
        log_callback(f"   Fixed columns (0-4): {first_five_columns}")
        log_callback(f"   End-of-Line Indicator: '{eol_col_name}' at index {eol_index}")
        log_callback(f"   Current total columns: {len(import_df.columns)}")
        log_callback(f"   Removing {len(columns_removed)} old grade columns: {columns_removed}")
        log_callback(f"   Result: {len(import_df.columns)} columns")
        log_callback(f"   Added grade column '{column_name}' at index 5")
                log_callback(f"")
                log_callback(f"❌ {friendly_msg}")
        log_callback("")
        log_callback("-" * 40)
        log_callback("NORMALIZING AND COMBINING PDFs")
        log_callback("-" * 40)
                log_callback(f"   Error processing {name}: {e}")
        log_callback("")
        log_callback(f"Created combined PDF: {len(pdf_paths)} submissions (sorted by last name)")
        log_callback("")
        log_callback("")
        log_callback("-" * 40)
        log_callback("SPLITTING COMBINED PDF")
        log_callback("-" * 40)
            log_callback(f"   Combined PDF has {total_pages} pages")
            log_callback(f"   Extracting student names from PDF...")
            log_callback(f"   Extracted {len(extracted_names)} names from PDF")
            log_callback(f"   First 10 names found:")
                log_callback(f"      {i:2d}. {name}")
                log_callback(f"      ... and {len(extracted_names) - 10} more")
            log_callback("")
            log_callback(f"Successfully split PDF for {students_processed} students")
            log_callback("")
            log_callback(f"Error splitting combined PDF: {e}")
            log_callback(f"   Could not find folder for: {student_name}")
        log_callback(f"   Processing {student_name}: {len(student_pages)} pages")
        log_callback(f"      Found folder: {os.path.basename(student_folder)}")
            log_callback(f"   No PDF found in {student_name}'s folder")
        log_callback(f"      Replacing: {original_pdfs[0]}")
        log_callback(f"   {student_name}: {len(student_pages)} pages → {original_pdfs[0]}")
        logs.append("")
        logs.append("=" * 60)
        logs.append(f"COMPLETION PROCESSING STARTED")
        logs.append(f"Class: {class_name}")
        logs.append("=" * 60)
        logs.append("")
                print(json.dumps(response))
            logs.append("")
            logs.append(f"Using specified ZIP file: {os.path.basename(selected_zip)}")
            logs.append(f"Looking for ZIP files in Downloads folder...")
                print(json.dumps(response))
                logs.append("")
                logs.append(f"Found {len(zip_files)} ZIP files:")
                logs.append("")
                    logs.append(f"  {i+1}. {os.path.basename(zip_file)}")
                logs.append("")
                logs.append("Multiple ZIP files found - user selection required")
                print(json.dumps(response, ensure_ascii=False))
            logs.append("")
            logs.append(f"Found 1 ZIP file: {os.path.basename(selected_zip)}")
            logs.append("")
            logs.append(f"Selected ZIP file: {os.path.basename(selected_zip)}")
        logs.append("")
        logs.append("-" * 40)
        logs.append("STARTING COMPLETION PROCESSING")
        logs.append("(Auto-assigning 10 points to all submissions)")
            logs.append("Mode: Don't override (adding new column after column E)")
            logs.append("Mode: Override column E (existing behavior)")
        logs.append("-" * 40)
        def log_callback(message):
            logs.append(message)
            logs.append("")
            logs.append("Completion processing completed successfully!")
            logs.append("")
            logs.append(f"Processing failed: {str(e)}")
                    logs.append("")
                    logs.append(f"Opened PDF file: {os.path.basename(result.combined_pdf_path)}")
                    logs.append("")
                    logs.append(f"Could not open PDF: {str(e)}")
        logs.append("")
        logs.append("=" * 60)
        logs.append("COMPLETION PROCESSING COMPLETED")
        logs.append("=" * 60)
        print("\n" + "=" * 60)
        print("COMPLETION PROCESSING COMPLETED")
        print("=" * 60)
        print()
            print(log)
        print()
        print("=" * 60)
        print("PROCESSING FINISHED")
        print("=" * 60)
        print(json.dumps(response), file=sys.stderr)
            logs.append("")
            logs.append(friendly_error)
            logs.append("")
            logs.append(f"Error: {error_msg}")
        print(json.dumps(error_response), file=sys.stderr)
        print(json.dumps({
        console.print()
        console.print(Panel.fit(
        console.print()
        logs.append("")
        logs.append("=" * 60)
        logs.append(f"QUIZ PROCESSING STARTED")
        logs.append(f"Class: {class_name}")
        logs.append("=" * 60)
        logs.append("")
                console.print("[error]✗ ZIP file not found[/error]")
                print(json.dumps(response))
            console.print(f"[success]✓[/success] Using: [cyan]{os.path.basename(selected_zip)}[/cyan]")
            logs.append("")
            logs.append(f"Using specified ZIP file: {os.path.basename(selected_zip)}")
            console.print("[info]🔍 Searching Downloads folder...[/info]")
            logs.append(f"Looking for quiz files in Downloads folder...")
                console.print("[error]✗ No ZIP files found[/error]")
                print(json.dumps(response))
                console.print(f"[warning]⚠ Found {len(zip_files)} ZIP files[/warning]")
                console.print()
                logs.append("")
                logs.append(f"Found {len(zip_files)} quiz files:")
                logs.append("")
                    logs.append(f"  {i+1}. {os.path.basename(zip_file)}")
                console.print(table)
                console.print()
                logs.append("")
                logs.append("Multiple ZIP files found - user selection required")
                print(json.dumps(response, ensure_ascii=False))
            console.print(f"[success]✓[/success] Found: [cyan]{os.path.basename(selected_zip)}[/cyan]")
            logs.append("")
            logs.append(f"Found 1 quiz file: {os.path.basename(selected_zip)}")
            logs.append("")
            logs.append(f"Selected quiz file: {os.path.basename(selected_zip)}")
        console.print()
        console.print(Panel(
        logs.append("")
        logs.append("-" * 40)
        logs.append("STARTING QUIZ PROCESSING")
        logs.append("-" * 40)
        def log_callback(message):
            logs.append(message)
                    console.print(f"[error]{message}[/error]")
                    console.print(f"[success]{message}[/success]")
                    console.print(f"[warning]{message}[/warning]")
                    console.print(f"[dim]{message}[/dim]")
                    console.print(message)
            logs.append("")
            logs.append("Processing completed successfully!")
            logs.append("")
            logs.append(f"Processing failed: {str(e)}")
        logs.append("")
        logs.append("=" * 60)
        logs.append("QUIZ PROCESSING COMPLETED")
        logs.append("=" * 60)
        console.print()
        console.print(Panel.fit(
        console.print()
        print(json.dumps(response), file=sys.stderr)
            logs.append("")
            logs.append(friendly_error)
            logs.append("")
            logs.append(f"Error: {error_msg}")
        console.print()
        console.print(Panel.fit(
        console.print()
        print(json.dumps(error_response), file=sys.stderr)
            log_callback("❌ Grade processing folder not found")
        log_callback(f"📦 Creating new ZIP: {original_zip_name}")
            log_callback("   Using preserved original index.html (exact copy)")
            log_callback("   Using original index.html from extraction (exact copy)")
            log_callback("   Warning: No original index.html found, generating new one")
            log_callback("   Generated new index.html (fallback - may not work with D2L)")
            log_callback("   Added index.html to ZIP root")
                log_callback(f"   Added root file: {file_name}")
                        log_callback(f"Added: {arcname}")
        log_callback(f"✅ Created ZIP file: {new_zip_path}")
        log_callback(f"❌ Error creating ZIP: {str(e)}")
        log_callback(f"   Details: {traceback.format_exc()}")
        print(json.dumps({
        logs.append("📦 Starting PDF split and rezip...")
        def log_callback(message):
        logs.append(f"📊 Split PDF for {students_count} students")
            logs.append(f"📦 Using assignment name: {original_zip_name}")
                    logs.append(f"📦 Using most recent ZIP: {original_zip_name}")
            logs.append("")
            logs.append("❌ Errors:")
                logs.append(f"   {error}")
        logs.append("")
        logs.append("✅ Done")
        print(json.dumps(response))
        error_logs.append("📦 Starting PDF split and rezip...")
        error_logs.append(friendly_error)
        error_logs.append("")
        error_logs.append("✅ Done")
        print(json.dumps(error_response))
        log_callback("")
        log_callback("-" * 40)
        log_callback("PROCESSING STUDENT SUBMISSIONS")
        log_callback("-" * 40)
        log_callback("")
        log_callback(f"Found {len(submission_map)} unique students (after filtering duplicates)")
        log_callback("")
                log_callback(f"   {name}: Could not match to roster")
        log_callback("")
        log_callback("Students who submitted multiple PDFs (combined automatically):")
            log_callback(f"   • {student_name}")
                    log_callback(f"   {name}: Found newer submission, using that")
                log_callback(f"   {name}: Matched using name parts → {roster_name}")
                log_callback(f"   {result['error']}")
                log_callback(msg)
        log_callback(msg)
        log_callback(msg)
